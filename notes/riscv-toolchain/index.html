<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="RISC-V Toolchain  There are two RISC-V toolchains that are popularly used:
 The GNU RISC-V toolchain The LLVM RISC-V toolchain  BothÂ toolchains provide a state-of-the-art optimising compiler, assembler, linker, and various other tools to build applications that run on RISC-V machines."><title>RISC-V Toolchain</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=ico href=https://pietraferreira.github.io/quartz//favicon.ico><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Source+Sans+Pro:wght@400;600;700&family=Fira+Code:wght@400;700&display=swap" rel=stylesheet><link href=https://pietraferreira.github.io/quartz/styles.9759d10f42f6dfbd0ef0f3c6980eb713.min.css rel=stylesheet><link href=https://pietraferreira.github.io/quartz/styles/_light_syntax.f1a931eb7b0ad54e91aa0e6e2dcef0c9.min.css rel=stylesheet id=theme-link><script src=https://pietraferreira.github.io/quartz/js/darkmode.b9d71d4974e9b68189fd8350687865f6.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://pietraferreira.github.io/quartz/js/popover.688c5dcb89a57776d7f1cbeaf6f7c44b.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script>const BASE_URL="https://pietraferreira.github.io/quartz/",fetchData=Promise.all([fetch("https://pietraferreira.github.io/quartz/indices/linkIndex.538d7b1fc1419e768a72bf93eea17d92.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://pietraferreira.github.io/quartz/indices/contentIndex.33a2c7e39e6a16b0b4aa54ef7b27291d.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const n=new URL(BASE_URL),s=n.pathname,o=window.location.pathname,i=s==o;addTitleToCodeBlocks();const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=i&&!1;drawGraph("https://pietraferreira.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2}),initPopover("https://pietraferreira.github.io/quartz",!0,!0)},init=(e=document)=>{addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/pietraferreira.github.io\/quartz\/js\/router.36189b3772031e6ae3c25f9e4f27a525.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://pietraferreira.github.io/quartz/js/search.cf33b507388f3dfd5513a2afcda7af41.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://pietraferreira.github.io/quartz/>ðŸª… Morioh</a></h1><svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg><div class=spacer></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>RISC-V Toolchain</h1><p class=meta>Last updated July 2, 2022</p><ul class=tags><li><a href=https://pietraferreira.github.io/quartz/tags/cs-concept/>Cs concept</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#where-to-download-the-toolchains-and-simulator>Where to download the toolchains and simulator</a></li><li><a href=#building-application-with-the-toolchain>Building Application with the Toolchain</a><ol><li><a href=#compiler-naming-convention>Compiler Naming Convention</a></li></ol></li><li><a href=#running-the-applications-on-spike-simulator>Running the Applications on Spike Simulator</a></li><li><a href=#running-applications-on-an-emulator>Running Applications on an Emulator</a><ol><li><a href=#build-qemu-with-the-risc-v-target>Build QEMU with the RISC-V target:</a></li><li><a href=#build-linux-for-the-risc-v-target>Build Linux for the RISC-V target:</a></li><li><a href=#build-the-busybox>Build the busybox:</a></li><li><a href=#to-run-the-linux-image-on-qemu-do>To run the Linux image on QEMU, do:</a></li><li><a href=#you-can-also-run-the-bare-metal-app-on-qemu-like-this>You can also run the bare metal app on QEMU like this:</a></li></ol></li><li><a href=#references>References</a><ol><li><a href=#risc-v-boards>RISC-V Boards:</a></li><li><a href=#risc-v-cores>RISC-V Cores:Â </a></li><li><a href=#toolchain-and-other-hardware-bringup-software-providers>Toolchain and other hardware bringup software providers:</a></li></ol></li></ol></nav></details></aside><a href=#risc-v-toolchain><h1 id=risc-v-toolchain><span class=hanchor arialabel=Anchor># </span>RISC-V Toolchain</h1></a><hr><p>There are two RISC-V toolchains that are popularly used:</p><ol><li>The GNU RISC-V toolchain</li><li>The LLVM RISC-V toolchain</li></ol><p>BothÂ toolchains provide a state-of-the-art optimising
<a href=/quartz/notes/compilers/ rel=noopener class=internal-link data-src=/quartz/notes/compilers/>compiler</a>, assembler, linker, and various other tools to build applications that run on RISC-V machines.</p><a href=#where-to-download-the-toolchains-and-simulator><h2 id=where-to-download-the-toolchains-and-simulator><span class=hanchor arialabel=Anchor># </span>Where to download the toolchains and simulator</h2></a><p>The officialÂ 
<a href=https://github.com/riscv-collab/riscv-gcc rel=noopener>RISC-V GitHub repository</a> provides the source code for the <code>riscv-gnu</code> toolchain, and the prebuilt toolchain can be downloaded from
<a href=https://github.com/riscv-software-src/riscv-gnu-toolchain rel=noopener>here</a>.</p><p>The RISC-V compiler is generally used as a cross-compiler, as many RISC-V processors are used for low-power embedded applications. Currently, the RISC-V cross-compilers can only be run onÂ 
<a href=https://en.wikipedia.org/wiki/Comparison_of_executable_file_formats rel=noopener>ELF targets</a> like Linux machines.</p><p>The RISC-V LLVM toolchain is not readily available from third-party providers, but one can build it from source by downloading the open source
<a href=https://github.com/llvm/llvm-project rel=noopener>llvm-project</a>. We describe an easy way to use the llvm toolchain with gnu sysroot.</p><p>The RISC-V simulator can be downloaded from the official RISC-V GitHub repository:
<a href=https://github.com/riscv/riscv-isa-sim rel=noopener>riscv/riscv-isa-sim: Spike, a RISC-V ISA Simulator</a>. Although RISC-V boards are readily available from several vendors, using simulators is an easy way to get started with RISC-V development.</p><a href=#building-application-with-the-toolchain><h2 id=building-application-with-the-toolchain><span class=hanchor arialabel=Anchor># </span>Building Application with the Toolchain</h2></a><p>In order to build a RISC-V application, using a
<a href=/quartz/notes/cross-compilation/ rel=noopener class=internal-link data-src=/quartz/notes/cross-compilation/>cross-compiler</a> toolchain is the same as any other cross-compiler-based development system. Two things are required:</p><ul><li>The
<a href=/quartz/notes/compiler-toolchains/ rel=noopener class=internal-link data-src=/quartz/notes/compiler-toolchains/>compiler toolchain</a></li><li><a href=/quartz/notes/sysroot/ rel=noopener class=internal-link data-src=/quartz/notes/sysroot/>sysroot</a></li></ul><p>We have described the compiler toolchain and sysroot in the first chapter. Before learning how to build applications with the RISC-V toolchain, weâ€™d like to introduce an interesting naming convention that has been used for cross-compilers.</p><a href=#compiler-naming-convention><h3 id=compiler-naming-convention><span class=hanchor arialabel=Anchor># </span>Compiler Naming Convention</h3></a><p>When you download the GCC toolchain, you&rsquo;ll find a <code>riscv64-unknown-elf-gcc</code> binary in the <code>bin</code> directory. This is the same GCC
<a href=/quartz/notes/compilers/ rel=noopener class=internal-link data-src=/quartz/notes/compilers/>compiler</a> with inbuilt information of sysroot and platform. It is a convention to name
<a href=/quartz/notes/cross-compilation/ rel=noopener class=internal-link data-src=/quartz/notes/cross-compilation/>cross-compilers</a> that way.</p><p>The naming is typicallyÂ using the <code>arch-vendor-os-abi</code> format. So, <code>riscv64-unknown-elf-gcc</code>Â means that this is a
<a href=/quartz/notes/cross-compilation/ rel=noopener class=internal-link data-src=/quartz/notes/cross-compilation/>cross-compiler</a> for RISC-V 64 bit, and tit will generate an <code>elf</code> binary,Â which can run on Linux machines for example. An excellent reference on naming convention can be found
<a href=http://web.eecs.umich.edu/~prabal/teaching/eecs373-f12/notes/notes-toolchain.pdf rel=noopener>here</a>. In cases where a compiler&rsquo;s name doesn&rsquo;t have the target triplet, the <code>-dumpmachine</code> flag can be used to get that:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ gcc -dumpmachine 
</span></span><span class=line><span class=cl>x86_64-linux-gnu
</span></span></code></pre></td></tr></table></div></div><p>With the <code>riscv64-unknown-elf-gcc</code> compiler handy, a file can then be compiled in the following ways:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ riscv64-unknown-elf-gcc -O2 -o a.out hello.c
</span></span><span class=line><span class=cl>$ riscv64-unknown-elf-gcc -O2 hello.c -mabi<span class=o>=</span>lp64d -march<span class=o>=</span>rv64ifd
</span></span></code></pre></td></tr></table></div></div><p>The <code>-march</code> flag is used to specify the target sub-architecture for which the assembly will be generated. The <code>-mabi</code> flag is used to specify data models. For more details on data models, refer toÂ 
<a href=https://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models rel=noopener>this</a> section of 64-bit computing in Wikipedia.</p><p>With the
<a href=/quartz/notes/llvm/ rel=noopener class=internal-link data-src=/quartz/notes/llvm/>llvm toolchain</a>, the binary can be built similarly. Assuming
<a href=/quartz/notes/sysroot/ rel=noopener class=internal-link data-src=/quartz/notes/sysroot/>sysroot</a> is in the <code>riscv64-unknown-elf</code> directory:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ clang test.c -c --sysroot riscv64-unknown-elf -target  
</span></span><span class=line><span class=cl>riscv64-unknown-elf -march<span class=o>=</span>rv64ifd
</span></span></code></pre></td></tr></table></div></div><p>RISC-V applications can be launched on a device, a simulator, or an emulator.</p><a href=#running-the-applications-on-spike-simulator><h2 id=running-the-applications-on-spike-simulator><span class=hanchor arialabel=Anchor># </span>Running the Applications on Spike Simulator</h2></a><p>One of the most convenient ways to run small applications is to use the RISC-V simulator. The build and installation steps are fairly straightforward. For this, you need the following dependencies:</p><ol><li>A Linux machine - building a Linux image on non-Linux machines is non-trivial, so it is recommended you have a Linux machine to begin with.</li><li>RISC-V toolchain:Â [https://github.com/riscv-software-src](
<a href=https://courses.edx.org/xblock/One rel=noopener>https://courses.edx.org/xblock/One</a> of the most convenient ways to run small applications is to use the RISC-V simulator. The build and installation steps are fairly straightforward. For this you need the following dependencies: A Linux machine. Building a Linux image on non-Linux machines is non-trivial so it is recommended you have a Linux machine to begin with. RISC-V toolchain (
<a href=https://github.com/riscv-software-src rel=noopener>https://github.com/riscv-software-src</a>) RISC-V simulator spike (
<a href=https://github.com/riscv-software-src/riscv-isa-sim rel=noopener>https://github.com/riscv-software-src/riscv-isa-sim</a>) RISC-V proxy kernel pk (
<a href=https://github.com/riscv-software-src/riscv-pk rel=noopener>https://github.com/riscv-software-src/riscv-pk</a>) The instructions to run a simple hello world app on the spike simulator is mentioned in their github README. To install the proxy kernel follow the instructions on their github README. For convenience, you can install both spike and pk in the same directory as the riscv64 toolchain directory by providing the path to toolchain directory as install prefix for both.)</li><li>RISC-V simulator spike:Â 
<a href=https://github.com/riscv-software-src/riscv-isa-sim rel=noopener>https://github.com/riscv-software-src/riscv-isa-sim</a></li><li>RISC-V proxy kernel pk:Â 
<a href=https://github.com/riscv-software-src/riscv-pk rel=noopener>https://github.com/riscv-software-src/riscv-pk</a></li></ol><p>The instructions to run a simple <code>hello-world</code> app on the Spike simulator are mentioned in their GitHub
<a href=https://github.com/riscv/riscv-isa-sim#compiling-and-running-a-simple-c-program rel=noopener>README</a>. To install the proxy kernel, follow the instructions on their GitHub
<a href=https://github.com/riscv-software-src/riscv-pk rel=noopener>README</a>. For convenience, you can install both <code>spike</code> and <code>pk</code> in the same directory as the <code>riscv64</code> toolchain directory by providing the path to the toolchain directory as install <code>prefix</code> for both.</p><a href=#running-applications-on-an-emulator><h2 id=running-applications-on-an-emulator><span class=hanchor arialabel=Anchor># </span>Running Applications on an Emulator</h2></a><p>Running a RISC-V application on an emulator gives you more flexibility, but the installation steps are more involved. In order to run a RISC-V application on an emulator, you need to have the following dependencies:</p><ol><li>A Linux machine - building a Linux image on non-Linux machines is non-trivial, so it is recommended you have a Linux machine to begin with.</li><li>RISC-V toolchain:Â [https://github.com/riscv-software-src](
<a href=https://courses.edx.org/xblock/Running rel=noopener>https://courses.edx.org/xblock/Running</a> an RISC-V application on an emulator gives you more flexibility but the installation steps are more involved. In order to run a RISC-V application on an emulator you need to have the following dependencies. A Linux machine. Building a Linux image on non-Linux machines is non-trivial so it is recommended you have a Linux machine to begin with. RISC-V toolchain (
<a href=https://github.com/riscv-software-src rel=noopener>https://github.com/riscv-software-src</a>) QEMU (git clone &ndash;depth 1 &ndash;branch v5.0.0
<a href=https://github.com/qemu/qemu rel=noopener>https://github.com/qemu/qemu</a>) Linux (git clone &ndash;depth 1 &ndash;branch v5.4
<a href=https://github.com/torvalds/linux rel=noopener>https://github.com/torvalds/linux</a>) Busybox (git clone &ndash;depth 1 git://git.busybox.net/busybox) The branches listed above are suggested versions and that may change frequently. You can choose other branches as well. The documentation above may become stale if any of the dependencies have breaking changes. Check
<a href=https://risc-v-getting-started-guide.readthedocs.io/en/latest/linux-qemu.html rel=noopener>https://risc-v-getting-started-guide.readthedocs.io/en/latest/linux-qemu.html</a> to see the latest supported versions. If this documentation does not work, be sure to ask in the linux-riscv mailing list. Build QEMU with the RISC-V target: cd qemu ./configure &ndash;target-list=riscv64-softmmu &ndash;prefix=/path/to/keep/qemu make -j $(nproc) make install Build Linux for the RISC-V target: cd linux make ARCH=riscv CROSS_COMPILE=riscv64-unknown-linux-gnu- defconfig make ARCH=riscv CROSS_COMPILE=riscv64-unknown-linux-gnu- -j $(nproc) Make sure to have the prefix of the cross compiler match from your toolchain. In the above example the gcc compiler is riscv64-unknown-linux-gnu-gcc so the CROSS_COMPILE flag is riscv64-unknown-linux-gnu- Build the busybox cd busybox CROSS_COMPILE=riscv64-unknown-linux-gnu- make defconfig CROSS_COMPILE=riscv64-unknown-linux-gnu- make -j $(nproc) To run linux image on QEMU run sudo /path/to/keep/qemu/bin/qemu-system-riscv64 -nographic -machine virt / -kernel /path/to/linux/image -append &ldquo;root=/dev/vda ro console=ttyS0&rdquo; / -drive file=busybox,format=raw,id=hd0 / -device virtio-blk-device,drive=hd0 You can also run bare metal app on QEMU like this /path/to/keep/qemu/bin/qemu-system-riscv64 -nographic -machine virt -kernel /path/to/binary -bios none For additional QEMU configurations for RISC-V, checkout the official documentation. In addition to simulators and emulators, RISC-V applications can be run on virtual machines as well as commercially available development boards. Additional documentation to debug bare metal issues can be found here. You can install the RISC-V virtual machine as documented here.)</li><li>QEMU:Â <code>git clone --depth 1 --branch v5.0.0 https://github.com/qemu/qemu</code></li><li>Linux: <code>git clone --depth 1 --branch v5.4 https://github.com/torvalds/linux</code></li><li>Busybox: <code>git clone --depth 1 git://git.busybox.net/busybox</code></li></ol><p>The branches listed above are suggested versions and that may change frequently. You can choose other branches as well. The documentation above may become stale if any of the dependencies have breaking changes. Check theÂ 
<a href=https://risc-v-getting-started-guide.readthedocs.io/en/latest/linux-qemu.html rel=noopener>Running 64- and 32-bit RISC-V Linux on QEMU documentation page</a> to see the latest supported versions. If this documentation does not work, be sure to ask in theÂ 
<a href=http://lists.infradead.org/pipermail/linux-riscv/ rel=noopener>linux-riscv</a> mailing list.</p><a href=#build-qemu-with-the-risc-v-target><h3 id=build-qemu-with-the-risc-v-target><span class=hanchor arialabel=Anchor># </span>Build QEMU with the RISC-V target:</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> qemu  
</span></span><span class=line><span class=cl>./configure --target-list<span class=o>=</span>riscv64-softmmu --prefix<span class=o>=</span>/path/to/keep/qemu  
</span></span><span class=line><span class=cl>make -j <span class=k>$(</span>nproc<span class=k>)</span>  
</span></span><span class=line><span class=cl>make install
</span></span></code></pre></td></tr></table></div></div><a href=#build-linux-for-the-risc-v-target><h3 id=build-linux-for-the-risc-v-target><span class=hanchor arialabel=Anchor># </span>Build Linux for the RISC-V target:</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> linux
</span></span><span class=line><span class=cl>make <span class=nv>ARCH</span><span class=o>=</span>riscv <span class=nv>CROSS_COMPILE</span><span class=o>=</span>riscv64-unknown-linux-gnu- defconfig 
</span></span><span class=line><span class=cl>make <span class=nv>ARCH</span><span class=o>=</span>riscv <span class=nv>CROSS_COMPILE</span><span class=o>=</span>riscv64-unknown-linux-gnu- -j <span class=k>$(</span>nproc<span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Make sure to have the prefix of the
<a href=/quartz/notes/cross-compilation/ rel=noopener class=internal-link data-src=/quartz/notes/cross-compilation/>cross-compiler</a> match from your toolchain. In the above example, the GCC
<a href=/quartz/notes/compilers/ rel=noopener class=internal-link data-src=/quartz/notes/compilers/>compiler</a> is <code>riscv64-unknown-linux-gnu-gcc</code> so the <code>CROSS_COMPILE</code> flag is <code>riscv64-unknown-linux-gnu-</code></p><a href=#build-the-busybox><h3 id=build-the-busybox><span class=hanchor arialabel=Anchor># </span>Build the busybox:</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> busybox
</span></span><span class=line><span class=cl><span class=nv>CROSS_COMPILE</span><span class=o>=</span>riscv64-unknown-linux-gnu- make defconfig 
</span></span><span class=line><span class=cl><span class=nv>CROSS_COMPILE</span><span class=o>=</span>riscv64-unknown-linux-gnu- make -j <span class=k>$(</span>nproc<span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><a href=#to-run-the-linux-image-on-qemu-do><h3 id=to-run-the-linux-image-on-qemu-do><span class=hanchor arialabel=Anchor># </span>To run the Linux image on QEMU, do:</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo /path/to/keep/qemu/bin/qemu-system-riscv64 -nographic -machin  
</span></span><span class=line><span class=cl>virt   
</span></span><span class=line><span class=cl>Â  Â  Â -kernel /path/to/linux/image -append <span class=s2>&#34;root=/dev/vda ro  
</span></span></span><span class=line><span class=cl><span class=s2>console=ttyS0&#34;</span> <span class=se>\ </span> 
</span></span><span class=line><span class=cl>Â  Â  Â -drive <span class=nv>file</span><span class=o>=</span>busybox,format<span class=o>=</span>raw,id<span class=o>=</span>hd0 <span class=se>\ </span> 
</span></span><span class=line><span class=cl>Â  Â  Â -device virtio-blk-device,drive<span class=o>=</span>hd0
</span></span></code></pre></td></tr></table></div></div><a href=#you-can-also-run-the-bare-metal-app-on-qemu-like-this><h3 id=you-can-also-run-the-bare-metal-app-on-qemu-like-this><span class=hanchor arialabel=Anchor># </span>You can also run the bare metal app on QEMU like this:</h3></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/path/to/keep/qemu/bin/qemu-system-riscv64 -nographic -machine virt  
</span></span><span class=line><span class=cl>-kernel /path/to/binary -bios none
</span></span></code></pre></td></tr></table></div></div><p>For additional QEMU configurations for RISC-V, check out theÂ 
<a href=https://wiki.qemu.org/Documentation/Platforms/RISCV rel=noopener>official documentation</a>. In addition to simulators and emulators, RISC-V applications can be run on virtual machines, as well as commercially available development boards.</p><p>Additional documentation to debug bare metal issues can be found
<a href=https://embeddedinn.xyz/articles/tutorial/Adding-a-custom-peripheral-to-QEMU/ rel=noopener>here</a>. You can install the RISC-V virtual machine as documented
<a href=https://wiki.debian.org/RISC-V rel=noopener>here</a>.</p><a href=#references><h2 id=references><span class=hanchor arialabel=Anchor># </span>References</h2></a><ul><li><a rel=noopener class="internal-link broken" data-src=mailto:tech-toolchain-runtime@lists.riscv.org>Tech: Toolchain & Runtime Subcommittee mailing list</a></li><li><a href=https://wiki.osdev.org/GCC_Cross-Compiler rel=noopener>GCC Cross-Compiler</a></li><li><a href=https://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models rel=noopener>64-bit data models</a></li><li><a href=https://en.wikipedia.org/wiki/64-bit_computing#64-bit_data_models rel=noopener>The linux-riscv Archives</a></li><li><a href=https://risc-v-getting-started-guide.readthedocs.io/en/latest/linux-qemu.html rel=noopener>Running 64- and 32-bit RISC-V Linux on QEMU</a></li><li><a href=https://wiki.qemu.org/Documentation/Platforms/RISCV rel=noopener>Qemu: Documentation/Platforms/RISCV</a></li><li><a href=https://wiki.debian.org/RISC-V rel=noopener>Debian - RISC-V Wiki</a></li></ul><a href=#risc-v-boards><h3 id=risc-v-boards><span class=hanchor arialabel=Anchor># </span>RISC-V Boards:</h3></a><p>TheÂ 
<a href=https://riscv.org/exchange/ rel=noopener>RISC-V Exchange</a> page is a collection of available physical hardware in the RISC-V ecosystem. This list is curated by the community.</p><a href=#risc-v-cores><h3 id=risc-v-cores><span class=hanchor arialabel=Anchor># </span>RISC-V Cores:Â </h3></a><p>TheÂ 
<a href=https://riscv.org/exchange/cores-socs/ rel=noopener>RISC-V Exchange: Cores & SoCs</a> page is a collection of available intellectual property (IP) cores and SoCs in the RISC-V ecosystem.</p><a href=#toolchain-and-other-hardware-bringup-software-providers><h3 id=toolchain-and-other-hardware-bringup-software-providers><span class=hanchor arialabel=Anchor># </span>Toolchain and other hardware bringup software providers:</h3></a><ul><li><a href=https://github.com/riscv-collab rel=noopener>RISC-V Software Collaboration</a></li><li><a href=https://github.com/sifive/freedom-tools/releases rel=noopener>sifive/freedom-tools</a></li><li><a href=https://github.com/lowRISC rel=noopener>lowRISC</a></li><li><a href=https://github.com/stnolting/riscv-gcc-prebuilt rel=noopener>stnolting/riscv-gcc-prebuilt</a></li><li><a href=https://www.sifive.com/software rel=noopener>SiFive/Software</a></li></ul></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/quartz/notes/compiler-toolchains/ data-ctx="RISC-V Toolchain" data-src=/notes/compiler-toolchains class=internal-link>Compiler Toolchains</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://pietraferreira.github.io/quartz/js/graph.afdb02e537635f9a611b53a988e5645b.js></script></div></div><div id=contact_buttons><footer><p>Made by Morioh using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2022</p><ul><li><a href=/>Home</a></li><li><a href=https://github.com/pietraferreira>Github</a></li></ul></footer></div></div></body></html>