<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="The relocation table records the list of items that the file needs (from other object files or libraries).
The relocation record contains information like: which instructions need to be relocated (the offsets), which symbols are involved with the relocation and how to relocate the files relative to the symbols."><title>Howto Table</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=ico href=https://pietraferreira.github.io/quartz//favicon.ico><link href=https://pietraferreira.github.io/quartz/styles.5c5e8e492b01ec554ac9a86fe1e7f16f.min.css rel=stylesheet><link href=https://pietraferreira.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://pietraferreira.github.io/quartz/js/darkmode.a93be4d36d657139e957880e320dd457.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/util.fa8e74b4065b97e6980a72cc472e436f.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://pietraferreira.github.io/quartz/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://pietraferreira.github.io/quartz/",fetchData=Promise.all([fetch("https://pietraferreira.github.io/quartz/indices/linkIndex.32e0df4af5fbb5ec08f86f5b5dafac2b.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://pietraferreira.github.io/quartz/indices/contentIndex.8bb4ff9dadc3765bbcf1266bcc38558a.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://pietraferreira.github.io/quartz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://pietraferreira.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/pietraferreira.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://pietraferreira.github.io/quartz/js/full-text-search.51f0b1753e9b30839d053f8a98cc20d1.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://pietraferreira.github.io/quartz/>ðŸª… Morioh</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Howto Table</h1><p class=meta>Last updated
May 11, 2023
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/notes/private/work/howto-table.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://pietraferreira.github.io/quartz/tags/cs-concept/relocations/>Cs concept relocations</a></li><li><a href=https://pietraferreira.github.io/quartz/tags/work/>Work</a></li><li><a href=https://pietraferreira.github.io/quartz/tags/help/>Help</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#definition>Definition</a></li><li><a href=#related-notes>Related Notes</a></li></ol></nav></details></aside><p>The
<a href=/quartz/notes/private/work/relocations/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/relocations/>relocation</a> table records the list of items that the file needs (from other object files or libraries).</p><p>The relocation record contains information like: which instructions need to be relocated (the offsets), which symbols are involved with the relocation and how to relocate the files relative to the symbols.</p><a href=#definition><h2 id=definition><span class=hanchor arialabel=Anchor># </span>Definition</h2></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>HOWTO</span> <span class=p>(</span><span class=n>R_RISCV_CVPCREL_UI12</span><span class=p>,</span>          <span class=cm>/* type */</span>
</span></span><span class=line><span class=cl>         <span class=mi>1</span><span class=p>,</span>                             <span class=cm>/* rightshift */</span>
</span></span><span class=line><span class=cl>         <span class=mi>2</span><span class=p>,</span>                             <span class=cm>/* size */</span>
</span></span><span class=line><span class=cl>         <span class=mi>32</span><span class=p>,</span>                            <span class=cm>/* bitsize */</span>
</span></span><span class=line><span class=cl>         <span class=n>TRUE</span><span class=p>,</span>                          <span class=cm>/* pc_relative */</span>
</span></span><span class=line><span class=cl>         <span class=mi>0</span><span class=p>,</span>                             <span class=cm>/* bitpos */</span>
</span></span><span class=line><span class=cl>         <span class=n>complain_overflow_unsigned</span><span class=p>,</span>    <span class=cm>/* complain_on_overflow */</span>
</span></span><span class=line><span class=cl>         <span class=n>bfd_elf_generic_reloc</span><span class=p>,</span>         <span class=cm>/* special_function */</span>
</span></span><span class=line><span class=cl>         <span class=s>&#34;R_RISCV_CVPCREL_UI12&#34;</span><span class=p>,</span>        <span class=cm>/* name */</span>
</span></span><span class=line><span class=cl>         <span class=n>FALSE</span><span class=p>,</span>                         <span class=cm>/* partial_inplace */</span>
</span></span><span class=line><span class=cl>         <span class=mi>0</span><span class=p>,</span>                             <span class=cm>/* src_mask */</span>
</span></span><span class=line><span class=cl>         <span class=n>ENCODE_ITYPE_IMM</span> <span class=p>(</span><span class=o>-</span><span class=mi>1U</span><span class=p>),</span>        <span class=cm>/* dst_mask */</span>
</span></span><span class=line><span class=cl>         <span class=n>TRUE</span><span class=p>),</span>                         <span class=cm>/* pcrel_offset */</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><em>type</em>: type field is there mainly for documentary use, meaning that the back end can do what it wants with it. It is important to note that normally the back end will store their idea of an external relocation number in this field.</li><li><em>right shift</em>: the value the final relocation is shifted right by, it drops any unwanted data from the relocation</li><li><em>size</em>: encoded size of the item to be relocated, it is not a power of two measure. You can use <code>bfd_get_reloc_size</code> to find the size of the item in bytes.</li><li><em>bitsize</em>: the number of bits in the field to be relocated, it is used when doing overflow checking.</li><li><em>pc_relative</em>: boolean -> if the relocation is relative to the item being relocated.</li><li><em>bitpos</em>: the bit position of the relocation value in the destination. The relocated value is left shifted by this amount.</li><li><em>complain_on_overflow</em>: what type of overflow error should be checked for when relocating -> Complain if the value overflows when considered as an unsigned number.</li><li><em>special_function</em>: if this field is non-null (it is) then the supplied function is called rather than the normal function, allowing really strange relocations to be accomplished.<ul><li><em>bfd_elf_generic_reloc</em>: in <code>bfd/elf.c:1307</code> -> it is for relocations against symbols (<code>SHT_RELA</code> etc).</li></ul></li><li><em>name</em>: textual name of the relocation type.</li><li><em>partial_inplace</em>: some formats record a relocation addend in the section contents rather than with the relocation. For ELF formats this is the distinction between <code>USE_REL</code> and <code>USE_RELA</code>. The value is false if addends are recorded within the relocations. All relocations for all ELF <code>USE_RELA</code> targets should set this field to false.</li><li><em>src_mask</em>: it detected the part of the instruction to be used in the relocation sum -> if relocations do have an addend in the relocation, then this field should normally be zero.</li><li><em>dst_mask</em>: selects which part of the instruction are replaced with a relocated value.</li><li><em>pcrel_offset</em>: when some formats create PC relative instructions, they leave the value of the pc of the place being relocated in the offset slot of the instruction, so that a PC relative relocation can be made by just adding in an ordinary offset. in the cases that the displacement part of the instruction is empty, this flags signals the fact.</li></ul><a href=#related-notes><h2 id=related-notes><span class=hanchor arialabel=Anchor># </span>Related Notes</h2></a><ul><li><a href=/quartz/notes/private/work/relocations/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/relocations/>Relocations</a></li><li><a href=/quartz/notes/private/work/plt-and-got/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/plt-and-got/>PLT and GOT</a></li><li><a href=/quartz/notes/private/work/linker/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/linker/>Linker</a></li><li><a href=/quartz/notes/general/linker-relaxation/ rel=noopener class=internal-link data-src=/quartz/notes/general/linker-relaxation/>Linker Relaxation</a></li><li><a href=/quartz/notes/private/work/jump-table/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/jump-table/>Jump Table</a></li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/quartz/notes/general/knowledge-hub/ data-ctx="HowTo Table" data-src=/notes/general/knowledge-hub class=internal-link>Knowledge Hub</a></li><li><a href=/quartz/notes/private/work/plt-and-got/ data-ctx="Howto Table" data-src=/notes/private/work/plt-and-got class=internal-link>PLT and GOT</a></li><li><a href=/quartz/notes/private/work/relocations/ data-ctx="Howto Table" data-src=/notes/private/work/relocations class=internal-link>Relocations</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://pietraferreira.github.io/quartz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Morioh using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2023</p><ul><li><a href=https://pietraferreira.github.io/quartz/>Home</a></li><li><a href=https://github.com/pietraferreira>Github</a></li></ul></footer></div></div></body></html>