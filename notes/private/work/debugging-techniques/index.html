<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Debugging is an essential part of the software development lifecycle. Even with the most robust programming practices bugs creep in, and debugging them is not a pleasant experience."><title>Debugging Techniques</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=ico href=https://pietraferreira.github.io/quartz//favicon.ico><link href=https://pietraferreira.github.io/quartz/styles.5c5e8e492b01ec554ac9a86fe1e7f16f.min.css rel=stylesheet><link href=https://pietraferreira.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://pietraferreira.github.io/quartz/js/darkmode.a93be4d36d657139e957880e320dd457.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/util.fa8e74b4065b97e6980a72cc472e436f.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://pietraferreira.github.io/quartz/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://pietraferreira.github.io/quartz/",fetchData=Promise.all([fetch("https://pietraferreira.github.io/quartz/indices/linkIndex.cae29452971a8a4ed3ffe0212bd74c04.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://pietraferreira.github.io/quartz/indices/contentIndex.4d4885754dc6961bcaba5168a7ac682a.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://pietraferreira.github.io/quartz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://pietraferreira.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/pietraferreira.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://pietraferreira.github.io/quartz/js/full-text-search.51f0b1753e9b30839d053f8a98cc20d1.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://pietraferreira.github.io/quartz/>ðŸª… Morioh</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Debugging Techniques</h1><p class=meta>Last updated
Sep 11, 2023
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/notes/private/work/debugging-techniques.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://pietraferreira.github.io/quartz/tags/work/engineer-training/>Work engineer training</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#types-of-bugs-in-programs>Types of Bugs in Programs</a></li><li><a href=#debugging-tools-and-techniques>Debugging Tools and Techniques</a><ol><li><a href=#instrumentation-debugging>Instrumentation debugging</a></li></ol></li><li><a href=#debugging-using-a-debugger>Debugging Using a Debugger</a></li><li><a href=#remote-debugging>Remote Debugging</a></li><li><a href=#jtag-based-debugging>JTAG-based Debugging</a></li><li><a href=#references>References</a></li></ol></nav></details></aside><p>Debugging is an essential part of the software development lifecycle. Even with the most robust programming practices bugs creep in, and debugging them is not a pleasant experience. On any widely used software, there are many developers contributing code, and debugging takes a significant portion of developers&rsquo; time.</p><p>That is why software development methodologies like
<a href=https://en.wikipedia.org/wiki/Test-driven_development rel=noopener>Test Driven Development</a>,
<a href=https://en.wikipedia.org/wiki/Defensive_programming rel=noopener>Defensive Programming</a>, andÂ 
<a href=https://en.wikipedia.org/wiki/Design_by_contract rel=noopener>Programming/Design by contract</a> are adopted by many organisations. Some programming languages even provide supportÂ for some methodologies; for example,Â 
<a href=https://en.wikipedia.org/wiki/D_%28programming_language%29 rel=noopener>D</a> implementsÂ 
<a href=https://dlang.org/spec/contracts.html rel=noopener>contract programming</a> features.</p><p>Debugging native applications is difficult because of the semantics of the programming language, the variety of dependent software, the dependencies on hardware features like threading model, memory model, etc. It is therefore essential to know the different debugging technologies available to us.</p><a href=#types-of-bugs-in-programs><h2 id=types-of-bugs-in-programs><span class=hanchor arialabel=Anchor># </span>Types of Bugs in Programs</h2></a><p>In general, application failures can be broadly classified into three categories:</p><ol><li>Programming errors (syntax errors, semantic errors, runtime errors)</li><li>System failure (memory errors, file corruption, network failure, etc.)</li><li>Invalid data (bad file name, bad data)</li></ol><p>Some bugs are difficult to classify in a specific bucket as the classification may depend on the point of reference. For example, data corruption by one application may cause a dependent application to throw a runtime error.</p><p>Depending on the type of failure, different tools and methodologies are deployed. In this chapter, we focus on programming errors and the following sections introduce tools and techniques pertaining to those.</p><a href=#debugging-tools-and-techniques><h2 id=debugging-tools-and-techniques><span class=hanchor arialabel=Anchor># </span>Debugging Tools and Techniques</h2></a><p>While working on toolchains, system bringup or developing system software, commonly used debugging techniques can be divided into four categories:</p><ol><li>Instrumentation-based debugging</li><li>Debugging using a debugger</li><li>Remote debugging using gdb</li><li>JTAG-based debugging</li></ol><a href=#instrumentation-debugging><h3 id=instrumentation-debugging><span class=hanchor arialabel=Anchor># </span>Instrumentation debugging</h3></a><p>Instrumentation-based debugging techniques are methods to insert code to programs, either manually or programmatically. This helps get insights into the code when the program runs. There are three commonly used techniques in this category:</p><ol><li>Print debugging</li><li>Assertion-based debugging</li><li>Sanitisers</li></ol><p>While print and assertion-based debugging are some of the earliest debugging techniques, sanitisers are relatively new. We briefly describe each technique below.</p><a href=#print-debugging><h4 id=print-debugging><span class=hanchor arialabel=Anchor># </span>Print Debugging</h4></a><p>The simplest debugging technique is to add a set of print statements in the program and observe the printed values. Inserting print statements at carefully identified program points can help debug the program.</p><p>This is one of the earliest debugging techniques and is quite useful even today. This approach however fails in several cases, as it does not scale well. Unless the programmer has good knowledge of the code at hand, it is difficult to find issues quickly with this approach.</p><a href=#assertion-based-debugging><h4 id=assertion-based-debugging><span class=hanchor arialabel=Anchor># </span>Assertion-based Debugging</h4></a><p>In order to establish preconditions and postconditions at various program points, it is common to insert assertions. Failure of assertion simplifies debugging. It also helps detect bugs early during the development stage. Usually, assertions are disabled in production code, so one of the first steps to debug is to enable assertions and run the failing test scenario.</p><a href=#sanitisers><h4 id=sanitisers><span class=hanchor arialabel=Anchor># </span>Sanitisers</h4></a><p>Both clang and GCC provide instrumentations (sanitisers) that can detect several well-known classes of errors like buffer overflow, memory corruption, etc. There are sanitiser, sanitiser, undefined behaviour sanitiser, thread sanitiser, etc.</p><p>This provides an automated way of detecting bugs. Sanitisers also require runtime support to find bugs and it is not available on all platforms. RISC-V for example currently has support for sanitiser and sanitiser only.Â 
<a href=https://github.com/google/sanitizers rel=noopener>This document</a> is the source of truth for all sanitiser documentation.</p><p>On some platforms,Â 
<a href=https://valgrind.org/ rel=noopener>Valgrind</a> can also detect errors that are detected by some sanitisers, like memory corruption, leaks, etc. Unfortunately, Valgrind is currently not available for RISC-V platforms.</p><a href=#debugging-using-a-debugger><h2 id=debugging-using-a-debugger><span class=hanchor arialabel=Anchor># </span>Debugging Using a Debugger</h2></a><p>When a debugger is available, it becomes very convenient to inspect programs, get backtraces, values of objects, the state of different threads, etc. Learning to effectively use a debugger like
<a href=/quartz/notes/private/work/gdb/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/gdb/>gdb</a> greatly simplifies software development.
<a rel=noopener class="internal-link broken" data-src=notes/private/work/useful-commands-dump.md#GDB%7cFrequently%20used%20%60gdb%60%20commands.></a></p><a href=#remote-debugging><h2 id=remote-debugging><span class=hanchor arialabel=Anchor># </span>Remote Debugging</h2></a><p>Info on remote debugging on GDB can be found
<a href=/quartz/notes/private/work/gdb/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/gdb/></a>.</p><a href=#jtag-based-debugging><h2 id=jtag-based-debugging><span class=hanchor arialabel=Anchor># </span>JTAG-based Debugging</h2></a><p>During the early bringup phase of hardware, there are no software capabilities. In order to debug bare metal applications or access different hardware blocks, JTAG (named after the Joint Test Action Group) is used as the transport mechanism.</p><p>Most modern hardware provides ways to directly trace instructions and data using a standard protocol called JTAG, although each hardware vendor may have different levels of support. It is frequently used to debug hardware issues.</p><p>RISC-V defines a standard interface for external debugging, this includes accessing hardware threads (hart) from the very first instruction, accessing memory, single-stepping instructions, etc.</p><a href=#references><h2 id=references><span class=hanchor arialabel=Anchor># </span>References</h2></a><ul><li><a href=https://www.cs.cornell.edu/courses/cs312/2006fa/lectures/lec26.html rel=noopener>Cornell University, CS312 Lecture 26, Debugging Techniques</a></li><li><a href=https://www.sourceware.org/gdb/current/onlinedocs/gdb.html rel=noopener>Debugging with GDB</a></li><li><a rel=noopener class="internal-link broken" data-src=aka%20JTAG%20debugging>Tim Newsome - RISC-V External Debug (aka JTAG debugging)</a>)</li><li><a href=https://riscv.org/wp-content/uploads/2019/03/riscv-debug-release.pdf rel=noopener>Tim Newsome and Megan Wachs - RISC-V External Debug Support Version 0.13.2</a></li><li><a href=https://five-embeddev.com/riscv-debug-spec/latest/introduction.html#sec:intro rel=noopener></a></li><li><a href=https://www.cs.usfca.edu/~parrt/course/601/lectures/programming.by.contract.html rel=noopener>University of San Francisco - Programming &ldquo;By Contract&rdquo;</a></li><li><a href=https://github.com/riscv/riscv-isa-sim#debugging-with-gdb rel=noopener></a></li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/quartz/notes/general/knowledge-hub/ data-ctx="Debugging Techniques" data-src=/notes/general/knowledge-hub class=internal-link>Knowledge Hub</a></li><li><a href=/quartz/notes/private/work/gdb/ data-ctx="Debugging Techniques" data-src=/notes/private/work/gdb class=internal-link>GDB</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://pietraferreira.github.io/quartz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Morioh using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2023</p><ul><li><a href=https://pietraferreira.github.io/quartz/>Home</a></li><li><a href=https://github.com/pietraferreira>Github</a></li></ul></footer></div></div></body></html>