<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Relocations      Different programs will be different sizes, so when the shared library gets mapped into the address space of different programs, it will be at different addresses."><title>Relocations</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=ico href=https://pietraferreira.github.io/quartz//favicon.ico><link href=https://pietraferreira.github.io/quartz/styles.5c5e8e492b01ec554ac9a86fe1e7f16f.min.css rel=stylesheet><link href=https://pietraferreira.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://pietraferreira.github.io/quartz/js/darkmode.a93be4d36d657139e957880e320dd457.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/util.fa8e74b4065b97e6980a72cc472e436f.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://pietraferreira.github.io/quartz/js/popover.9b72b70bd35617d0635e9d15463662b2.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://pietraferreira.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,PRODUCTION=!0,BASE_URL="https://pietraferreira.github.io/quartz/",fetchData=Promise.all([fetch("https://pietraferreira.github.io/quartz/indices/linkIndex.41cc197e41e8df8dfa3334da5d04b912.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://pietraferreira.github.io/quartz/indices/contentIndex.93ab403a2838aa374d9a99e766045b91.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://pietraferreira.github.io/quartz",!0,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://pietraferreira.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'‚Äô':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/pietraferreira.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://pietraferreira.github.io/quartz/js/full-text-search.51f0b1753e9b30839d053f8a98cc20d1.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://pietraferreira.github.io/quartz/>ü™Ö Morioh</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Relocations</h1><p class=meta>Last updated
May 11, 2023
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/notes/private/work/relocations.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://pietraferreira.github.io/quartz/tags/help/>Help</a></li><li><a href=https://pietraferreira.github.io/quartz/tags/cs-concept/relocations/>Cs concept relocations</a></li><li><a href=https://pietraferreira.github.io/quartz/tags/cs-concept/linker/>Cs concept linker</a></li><li><a href=https://pietraferreira.github.io/quartz/tags/work/riscv/>Work riscv</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#what-are-relocations>What are relocations?</a></li><li><a href=#relocation-entries>Relocation Entries</a></li><li><a href=#relocation-types>Relocation Types</a></li><li><a href=#risc-v-relocations>RISC-V Relocations</a><ol><li><a href=#implementation-practical>Implementation (Practical)</a></li></ol></li><li><a href=#references>References</a></li><li><a href=#related-notes>Related Notes</a></li></ol></nav></details></aside><a href=#relocations><h1 id=relocations><span class=hanchor arialabel=Anchor># </span>Relocations</h1></a><hr><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toc data-lang=toc></code></pre></td></tr></table></div></div><hr><p>Different programs will be different sizes, so when the shared library gets mapped into the address space of different programs, it will be at different addresses. This in turn means that all of the functions and variables in the library are in different places.</p><p>Now, if all of the ways of referring to addresses are relative (&ldquo;the value +1020 bytes from here&rdquo;) rather than absolute (&ldquo;the value at <code>0x102218BF</code>&rdquo;) this is less of a problem, but this isn&rsquo;t always possible. If not, then all of these absolute addresses need to have a suitable offset added to them ‚Äî this is relocation.</p><a href=#what-are-relocations><h2 id=what-are-relocations><span class=hanchor arialabel=Anchor># </span>What are relocations?</h2></a><p>Symbolic references and symbolic definitions have to be connected with one another. The mechanism to connect them is what is known as relocations.</p><p>A relocation can be thought of as a note that a particular address will need to be fixed at load time. Before the code is ready to run you will need to go through and read all the relocations and fix the addresses it refers to to point to the right place.</p><p>For example, we have a program that adds the value of two global variables together. In order for them to be successfully referenced, their address have to resolved. Or for example if the program is calling a function from an external dependency, the address of that function will also have to be computed prior to transferring control of execution to it.</p><p>During compilation, there is a specific stage were relocatable objects are generated. They contain all the information required to map symbolic references to its corresponding definitions. Populating symbolic references on symbolic definitions takes place during the linking phase of the compilation process.</p><p>Compilation process:</p><p><img src=https://pietraferreira.github.io/quartz//notes/images/Pasted%20image%2020220802100501.png width=auto alt="Pasted image 20220802100501"></p><p>We can relocate:</p><ul><li>Generic object files (<code>*.o</code>)</li><li>Kernel object files (<code>*.ko</code>)</li><li>Shared object files (<code>*.so</code>)</li></ul><p>Generic object files are the ones used for static linking, they are only relevant in the compilation process and essentially, any given symbolic definition will become part of the main executable being generated.</p><p>Some of the benefits are that there is no need to rely on external dependencies. On the other hand, they can become pretty large as they need all of the dependencies in the binary.</p><p>Shared objects support being linked on runtime, and they may be shared across different processes. However, relocations of dynamic dependencies have to be done at runtime ->
<a href=/quartz/notes/private/work/linker/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/linker/><strong>dynamic linking</strong></a>.</p><p>They happen at runtime because the symbolic definitions do not exist within the main binary&rsquo;s context, but within external shared objects. These dynamic references do not get populated until the correspondent external dependencies are loaded in memory.</p><a href=#relocation-entries><h2 id=relocation-entries><span class=hanchor arialabel=Anchor># </span>Relocation Entries</h2></a><p>Relocation information is held in relocatable entries, located in specific relocation sections within the ELF object. They are implemented in the form of structures, there are two different ones: <code>Elfxx_Rel</code> and <code>Elfxx_Rela</code>:</p><p><img src=https://pietraferreira.github.io/quartz//notes/images/Pasted%20image%2020220802101452.png width=auto alt="Pasted image 20220802101452"></p><p>The only different is that <code>Rela</code> has an extra field for the addend. They are mutually exclusive, meaning only one type of entry is used.</p><p>Normally the type of entry is architecture dependant, for example in x86 <code>Elf32_Rel</code> is used whereas for <code>x86_64</code> they use <code>Elf64_Rela</code>.</p><p>What do the fields mean?</p><ul><li><code>r_offset</code>: holds the location where a particular relocation has to take place, address to fix.</li><li><code>r_info</code>: both the symbol index within a symbol table of the correspondent symbol that has to be relocation and the relocation type for that specific symbol. What has to be done to fix this code up, a &ldquo;fix-up&rdquo;. They are retrieved using macros like:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=n>ELF32_R_SYM</span><span class=p>(</span><span class=n>info</span><span class=p>)((</span><span class=n>info</span><span class=p>)</span><span class=o>&gt;&gt;</span><span class=mi>8</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ELF32_R_TYPE</span><span class=p>(</span><span class=n>info</span><span class=p>)((</span><span class=kt>unsigned</span> <span class=kt>char</span><span class=p>)(</span><span class=n>info</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>r_addend</code>: a constant addend to be added to compute the value to be stored in a given relocation reference. For example, if the relocation is for symbol <code>i</code> because the original code is doing something like <code>i[8]</code>, the addend will be set to 8. This means: find address of i and go 8 past it.</li></ul><p>Relocation entries are always found in some relocation section, every relocation section may reference two additional sections:</p><ul><li>A relocation section will always be linked to its corresponded symbol table. The table can be located as a section in the section header table, and its index can be retrieved by the <code>sh_link</code> field of the relocation section&rsquo;s <code>Elfxx_Shdr</code> instance.</li><li>The section index where to apply the offset can be retrieved by the relocation section&rsquo;s <code>Elxx_Shdr sh_info</code> field.</li></ul><p><img src=https://pietraferreira.github.io/quartz//notes/images/Pasted%20image%2020220802102836.png width=auto alt="Pasted image 20220802102836"></p><p>As you can see, the relocation section is linked to two other sections. One of them is the symbol table, where the symbols that will be relocated are held. In this example, the section is the <code>.dynsym</code> section, the symbol table that holds symbols for dynamic linking.</p><p>The additional section linked to the relocation section is where the relocations are going to take place: the <strong>.got.plt</strong> section, which holds a table of pointers (an interface for the application to access relocated dynamically linked procedures addresses).</p><a href=#relocation-types><h2 id=relocation-types><span class=hanchor arialabel=Anchor># </span>Relocation Types</h2></a><p><code>r_info</code> of <code>Elfxx_Rela</code> and <code>Elfxx_Rel</code> contains two encoded values, which are the <strong>symbol index</strong> where the relocation is being applied to and the <strong>relocation type</strong> to apply.</p><a href=#risc-v-relocations><h2 id=risc-v-relocations><span class=hanchor arialabel=Anchor># </span>RISC-V Relocations</h2></a><p>Can be found
<a href=https://github.com/riscv-non-isa/riscv-elf-psabi-doc/blob/master/riscv-elf.adoc rel=noopener>here</a>.</p><a href=#implementation-practical><h3 id=implementation-practical><span class=hanchor arialabel=Anchor># </span>Implementation (Practical)</h3></a><a href=#important-commands><h4 id=important-commands><span class=hanchor arialabel=Anchor># </span>Important Commands</h4></a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>riscv32-unknown-elf-as -march<span class=o>=</span>rv32i -o &lt;file&gt;.o &lt;file&gt;.s
</span></span><span class=line><span class=cl>riscv32-unknown-elf-gcc -march<span class=o>=</span>rv32i -Os -c &lt;newfile&gt;.c
</span></span><span class=line><span class=cl>riscv32-unknown-elf-gcc -o &lt;newfile&gt;.c &lt;newfile&gt;.o &lt;file&gt;.o
</span></span></code></pre></td></tr></table></div></div><ul><li><code>-c</code> stops the compiler before link time, the third command links the object files together.</li></ul><a href=#where-are-the-relocations><h4 id=where-are-the-relocations><span class=hanchor arialabel=Anchor># </span>Where are the relocations?</h4></a><p>They can be found in:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bfd/elfxx-riscv.c <span class=c1># -&gt; describes the relocation in the howto table</span>
</span></span><span class=line><span class=cl>bfd/elfnn-riscv.c <span class=c1># -&gt; add relocation mask </span>
</span></span><span class=line><span class=cl>bfd/reloc.c <span class=c1># -&gt; add the relocation BFD name</span>
</span></span><span class=line><span class=cl>include/elf/riscv.h <span class=c1># -&gt; add the relocation number</span>
</span></span><span class=line><span class=cl>gas/config/tc-riscv.c <span class=c1># -&gt; where the magic happens</span>
</span></span></code></pre></td></tr></table></div></div><p>If we use the CORE-V relocations as an example, we have <code>BFD_RELOC_RISCV_CVPCREL_UI12</code>, which is a 12-bit relocation for 12-bit immediates found in <code>cv.starti</code> and <code>cv.endi</code>. Its relocation number is 224.</p><p>You can find the
<a href=/quartz/notes/private/work/howto-table/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/howto-table/><strong>howto</strong> table</a> in <code>bfd/elfxx-riscv.c</code> which contains entries for each relocation. The first field uses the table from <code>include/elf/riscv.h</code>.</p><a href=#howto-table-notes-on-how-core-v-relocation-was-implemented><h4 id=howto-table-notes-on-how-core-v-relocation-was-implemented><span class=hanchor arialabel=Anchor># </span>Howto Table (notes on how CORE-V relocation was implemented)</h4></a><p><strong>Step 1:</strong> Check that symbol address exists via <em>fixP‚Üífx_addsy</em>. If false the case will just break and not go through the following steps.</p><p><strong>Step 2:</strong> Uses the howto table to look up the relocation. The howto table can be found in <em><strong>bfd/elfxx-riscv.c</strong></em>. The first field uses the table from <em><strong>include/elf/riscv.h</strong></em>.</p><p><strong>Step 3:</strong> Set the <em>delta</em> and <em>target</em> values to increase objdump readability.</p><p>Target is the value of the symbol found using <em>S_GET_VALUE</em>. Since the symbol is local, it will use <em>resolve_symbol_value</em> to find the value. This is called during the final pass over the symbol table to resolve any symbols with complex values.</p><p>Delta is the PC relative value found via ‚Äú<em>target - md_pcrel_from (fixP)‚Äù</em>, where fixP is the symbol.</p><p><strong>Step 4:</strong> Check if the relocation overflows. <em>bfd_check_overflow</em> will return <em>bfd_reloc_ok</em> or <em>bfd_reloc_overflow</em>. If overflow, <em>as_fatal</em> will be used, ending the assembly.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>bfd_reloc_status_type bfd_check_overflow
</span></span><span class=line><span class=cl>    (enum complain_overflow how, // howto-&gt;complain_on_overflow
</span></span><span class=line><span class=cl>    unsigned int bitsize, // Relocation has bitsize significant bits
</span></span><span class=line><span class=cl>    unsigned int rightshift, // This relocation requires right shift by 1 (common)
</span></span><span class=line><span class=cl>    unsigned int addrsize, // Machine has addrsize significant bits
</span></span><span class=line><span class=cl>    bfd_vma relocation); // The relocation found in the howto table
</span></span></code></pre></td></tr></table></div></div><p><strong>Step 5:</strong> Remove some of the information from the header records of object files using <em>bfd_putl32</em>. The function masks to remove the information.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>void
</span></span><span class=line><span class=cl>bfd_putl32 (bfd_vma data, void *p) {
</span></span><span class=line><span class=cl>    bfd_byte *addr = (bfd_byte *) p;
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    addr[0] = data &amp; 0xff;
</span></span><span class=line><span class=cl>    addr[1] = (data &gt;&gt; 8) &amp; 0xff;
</span></span><span class=line><span class=cl>    addr[2] = (data &gt;&gt; 16) &amp; 0xff;
</span></span><span class=line><span class=cl>    addr[3] = (data &gt;&gt; 24) &amp; 0xff;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><hr><a href=#references><h2 id=references><span class=hanchor arialabel=Anchor># </span>References</h2></a><ul><li><a href=https://www.intezer.com/blog/malware-analysis/executable-and-linkable-format-101-part-3-relocations/ rel=noopener>https://www.intezer.com/blog/malware-analysis/executable-and-linkable-format-101-part-3-relocations/</a></li><li><a href=https://github.com/riscv-non-isa/riscv-elf-psabi-doc/blob/master/riscv-elf.adoc#reloc-table rel=noopener>https://github.com/riscv-non-isa/riscv-elf-psabi-doc/blob/master/riscv-elf.adoc#reloc-table</a></li><li><a href=https://www.intezer.com/blog/malware-analysis/executable-linkable-format-101-part-4-dynamic-linking/ rel=noopener>https://www.intezer.com/blog/malware-analysis/executable-linkable-format-101-part-4-dynamic-linking/</a></li><li><a href=https://man7.org/linux/man-pages/man8/ld.so.8.html rel=noopener>https://man7.org/linux/man-pages/man8/ld.so.8.html</a></li><li><a href=https://codywu2010.wordpress.com/2014/11/29/about-elf-pie-pic-and-else/ rel=noopener>https://codywu2010.wordpress.com/2014/11/29/about-elf-pie-pic-and-else/</a></li><li><a href=http://bottomupcs.sourceforge.net/csbu/x3824.htm rel=noopener>http://bottomupcs.sourceforge.net/csbu/x3824.htm</a></li><li><a href=https://www.sifive.com/blog/all-aboard-part-2-relocations rel=noopener>https://www.sifive.com/blog/all-aboard-part-2-relocations</a></li></ul><a href=#related-notes><h2 id=related-notes><span class=hanchor arialabel=Anchor># </span>Related Notes</h2></a><ul><li><a href=/quartz/notes/private/work/linker/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/linker/>Linker</a></li><li><a href=/quartz/notes/private/work/howto-table/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/howto-table/>Howto Table</a></li><li><a href=/quartz/notes/private/work/plt-and-got/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/plt-and-got/>PLT and GOT</a></li><li><a href=/quartz/notes/general/linker-relaxation/ rel=noopener class=internal-link data-src=/quartz/notes/general/linker-relaxation/>Linker Relaxation</a></li><li><a href=/quartz/notes/private/work/jump-table/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/jump-table/>Jump Table</a></li><li><a href=/quartz/notes/private/work/riscv-assembler-reference/ rel=noopener class=internal-link data-src=/quartz/notes/private/work/riscv-assembler-reference/>Assembler</a></li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/quartz/notes/general/fixups/ data-ctx=relocations data-src=/notes/general/fixups class=internal-link>Fixups</a></li><li><a href=/quartz/notes/general/gcc/ data-ctx=Relocations data-src=/notes/general/gcc class=internal-link>GCC</a></li><li><a href=/quartz/notes/general/gnu/ data-ctx=Relocations data-src=/notes/general/gnu class=internal-link>GNU</a></li><li><a href=/quartz/notes/general/knowledge-hub/ data-ctx=Relocations data-src=/notes/general/knowledge-hub class=internal-link>Knowledge Hub</a></li><li><a href=/quartz/notes/private/work/howto-table/ data-ctx=Relocations data-src=/notes/private/work/howto-table class=internal-link>Howto Table</a></li><li><a href=/quartz/notes/private/work/plt-and-got/ data-ctx=Relocations data-src=/notes/private/work/plt-and-got class=internal-link>PLT and GOT</a></li><li><a href=/quartz/notes/private/work/relocation-prototype/2022-06-02/ data-ctx=relocation data-src=/notes/private/work/relocation-prototype/2022-06-02 class=internal-link>2022-06-02</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://pietraferreira.github.io/quartz/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Made by Morioh using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, ¬© 2023</p><ul><li><a href=https://pietraferreira.github.io/quartz/>Home</a></li><li><a href=https://github.com/pietraferreira>Github</a></li></ul></footer></div></div></body></html>